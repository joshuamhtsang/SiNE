# SiNE Example: Vacuum (Free-Space) Link at 20m
#
# This example demonstrates free-space wireless propagation with:
# - Two nodes in vacuum (no obstacles or reflections)
# - 20m separation distance along X-axis
# - Direct line-of-sight path only
# - WiFi6 5GHz parameters (5.18 GHz, 80 MHz)
#
# This scenario is useful for:
# - Baseline link performance testing
# - Validating free-space path loss calculations (FSPL)
# - Comparing against theoretical maximum range
# - Benchmarking against scenarios with obstacles
#
# Expected behavior:
# - Free-Space Path Loss (FSPL): ~68.3 dB at 20m and 5.18 GHz
# - Received Power: ~-48.3 dBm (20 dBm TX - 68.3 dB path loss)
# - Noise Floor: ~-88 dBm (80 MHz, 7 dB NF)
# - SNR: ~39.7 dB (excellent link quality)
# - BER/BLER: Near zero with 64-QAM LDPC
# - Single LOS path, no multipath or reflections
#
# Usage:
#   1. Start the channel server:
#      uv run sine channel-server
#
#   2. Deploy the emulation (requires sudo for netem):
#      sudo $(which uv) run sine deploy examples/vacuum_20m/network.yaml
#      (IP addresses are automatically configured from the topology YAML)
#
#   3. Test connectivity with iperf3:
#      Terminal 1 (node1 server):
#        docker exec -it clab-vacuum-20m-node1 iperf3 -s
#
#      Terminal 2 (node2 client):
#        docker exec -it clab-vacuum-20m-node2 iperf3 -c 192.168.1.1
#
#   4. Cleanup:
#      sudo $(which uv) run sine destroy examples/vacuum_20m/network.yaml

name: vacuum-20m
prefix: clab

topology:
  # Scene configuration
  # Empty vacuum scene (no geometry, free-space propagation)
  scene:
    file: scenes/vacuum.xml

  # Node definitions
  nodes:
    # First node at origin
    node1:
      kind: linux
      image: sine-node:latest
      interfaces:
        eth1:
          ip_address: 192.168.1.1/24
          wireless:
            rf_power_dbm: 20.0          # Standard transmit power
            rx_sensitivity_dbm: -80.0   # WiFi 6 receiver sensitivity (minimum detectable signal)
            antenna_pattern: iso        # Isotropic antenna pattern (ideal for free space)
            polarization: V             # Vertical polarization
            antenna_gain_dbi: 0.0       # Antenna pattern selection (NOT added to link budget)
            frequency_ghz: 5.18         # WiFi6 5GHz channel 36
            bandwidth_mhz: 80           # 80 MHz channel width
            modulation: 64qam           # 64-QAM modulation
            fec_type: ldpc              # LDPC forward error correction
            fec_code_rate: 0.5          # Rate-1/2 coding
            position:
              x: 0.0                    # Origin
              y: 0.0
              z: 1.0                    # 1m height (typical antenna height)

    # Second node at 20m distance
    node2:
      kind: linux
      image: sine-node:latest
      interfaces:
        eth1:
          ip_address: 192.168.1.2/24
          wireless:
            rf_power_dbm: 20.0          # Same transmit power
            rx_sensitivity_dbm: -80.0   # WiFi 6 receiver sensitivity (minimum detectable signal)
            antenna_pattern: iso        # Isotropic antenna pattern
            polarization: V             # Vertical polarization
            antenna_gain_dbi: 0.0       # Antenna pattern selection (NOT added to link budget)
            frequency_ghz: 5.18         # Same channel as node1
            bandwidth_mhz: 80           # 80 MHz channel width
            modulation: 64qam           # 64-QAM modulation
            fec_type: ldpc              # LDPC forward error correction
            fec_code_rate: 0.5          # Rate-1/2 coding
            position:
              x: 20.0                   # 20m along X-axis (exactly 20m from origin)
              y: 0.0                    # Same Y coordinate (linear alignment)
              z: 1.0                    # Same height (level link for symmetry)

  # Links between nodes
  # Endpoints must be in "node:interface" format
  links:
    - endpoints: [node1:eth1, node2:eth1]

  # Channel computation server URL
  channel_server: "http://localhost:8000"

  # Mobility polling interval (milliseconds)
  mobility_poll_ms: 100
